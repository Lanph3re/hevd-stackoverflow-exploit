Breakpoint 1 hit
HEVD!TriggerBufferOverflowStack+0x10b:
fffff803`103c66bf c3              ret
1: kd> r
rax=0000000000000000 rbx=0000000000000003 rcx=ffffb886f0221f80
rdx=000049875cdee080 rsi=00000000c00000bb rdi=000000000000004d
rip=fffff803103c66bf rsp=ffffb886f0222798 rbp=ffff880da8defd80
 r8=0000000000000000  r9=0000000000000000 r10=fffff803103c5078
r11=ffffb886f0222780 r12=0000000000000000 r13=0000000000000000
r14=ffff880da8defe50 r15=ffff880db13c5e10
iopl=0         nv up ei pl zr na po nc
cs=0010  ss=0018  ds=002b  es=002b  fs=0053  gs=002b             efl=00040246
HEVD!TriggerBufferOverflowStack+0x10b:
fffff803`103c66bf c3              ret
1: kd> dq rsp
ffffb886`f0222798  fffff803`103c65ae 00000000`00000003
ffffb886`f02227a8  00000000`c00000bb 00000000`0000004d
ffffb886`f02227b8  fffff803`077f9211 00000000`00000000
ffffb886`f02227c8  fffff803`103c5253 00000000`00000000
ffffb886`f02227d8  fffff803`07ee52c0 fffff803`103c82d0
ffffb886`f02227e8  00000000`00222003 ffff880d`b3d061f0
ffffb886`f02227f8  fffff803`07446d45 ffff880d`a8defd80
ffffb886`f0222808  00000000`00000002 00000000`00000001
ffffb886`f0222818  ffff880d`b3d061f0 ffff880d`b13c5e10
ffffb886`f0222828  ffff880d`a8defe98 ffff880d`b3d061f0
ffffb886`f0222838  fffff803`0780eb18 ffffb886`f0222b80
ffffb886`f0222848  ffff880d`a8defd80 00000000`00000001
ffffb886`f0222858  ffff880d`00000000 00000000`00000000
ffffb886`f0222868  00000000`00000001 ffff880d`b3d061f0
ffffb886`f0222878  ffff880d`b13c5e10 00000000`00000003
ffffb886`f0222888  00000000`00000000 ffff880d`b3d061f0

HEVD!BufferOverflowStackIoctlHandler+0x1a:
fffff803`103c65ae 4883c428       add     rsp, 28h
fffff803`103c65b2 c3             ret     
fffff803`103c65b3 cc             int     3

HEVD!IrpDeviceIoCtlHandler+0x1db:
fffff803`103c5253 4c8d0576300000 lea     r8, [HEVD! ?? ::NNGAKEGL::`string' (fffff803`103c82d0)]
fffff803`103c525a e9b0040000     jmp     HEVD!IrpDeviceIoCtlHandler+0x697 (fffff803`103c570f)

...

fffff803`103c570f 8bd3           mov     edx, ebx
fffff803`103c5711 8bcf           mov     ecx, edi
fffff803`103c5713 8bf0           mov     esi, eax
fffff803`103c5715 ff15edc8f7ff   call    qword ptr [HEVD!_imp_DbgPrintEx (fffff803`10342008)]
fffff803`103c571b 4883653800     and     qword ptr [rbp+38h], 0
fffff803`103c5720 33d2           xor     edx, edx
fffff803`103c5722 488bcd         mov     rcx, rbp
fffff803`103c5725 897530         mov     dword ptr [rbp+30h], esi
fffff803`103c5728 ff15e2c8f7ff   call    qword ptr [HEVD!_imp_IofCompleteRequest (fffff803`10342010)]
fffff803`103c572e 488b5c2430     mov     rbx, qword ptr [rsp+30h]
fffff803`103c5733 8bc6           mov     eax, esi
fffff803`103c5735 488b742440     mov     rsi, qword ptr [rsp+40h]
fffff803`103c573a 488b6c2438     mov     rbp, qword ptr [rsp+38h]
fffff803`103c573f 488b7c2448     mov     rdi, qword ptr [rsp+48h]
fffff803`103c5744 4883c420       add     rsp, 20h
fffff803`103c5748 415e           pop     r14
fffff803`103c574a c3             ret     

// rbp: 2
// rdi: irp
// rsi: 1

bp HEVD!TriggerBufferOverflowStack
bp HEVD!TriggerBufferOverflowStack+0x10b

00001aabcdef12312412

// mov rax,qword ptr [rax+38h]
// mov qword ptr [rcx+18h],rax

2: kd> dq ffff91c8`e4723008
ffff91c8`e4723008  8a000002`29d4f867 00000000`00000000
ffff91c8`e4723018  00000000`00000000 0a000002`0c056867
ffff91c8`e4723028  00000000`00000000 00000000`00000000
ffff91c8`e4723038  00000000`00000000 00000000`00000000
ffff91c8`e4723048  00000000`00000000 00000000`00000000
ffff91c8`e4723058  00000000`00000000 00000000`00000000
ffff91c8`e4723068  00000000`00000000 00000000`00000000
ffff91c8`e4723078  00000000`00000000 00000000`00000000
2: kd> ? rax+0x18
Evaluate expression: 720575949170894975 = 0a000002`0c05687f
2: kd> ? rax
Evaluate expression: 720575949170894951 = 0a000002`0c056867
2: kd> ? rcx+0x18
Evaluate expression: -121182964535264 = ffff91c8`e4723020
